# Gitの操作

## Gitの基本的な仕組み
 ローカルは、3つのエリアに分かれている
 + ワークツリー
 + ステージ
 + リポジトリ

### ワークツリー
 手元のファイルの作業場

### ステージ
 コミットする変更を準備する変更
 コミット = スナップショットの記録

### リポジトリ
 スナップショットを記録する場

## この仕組みの裏側は???
 index.htmlをバージョン管理するとする。
 リポジトリには、圧縮ファイルA(index.html)のファイル内容を圧縮)を作成する。

 ステージ上のインデックス上では、index.htmlのファイル構成を記録する。

 ツリーを構成する ＆ コミットを作成する 
 コミットには、ツリーと作成者、日時などを作成する。

### もし新しいファイルが追加されたら...
 圧縮ファイルB(css/home.css)が作成されたとする。

 ステージ上のインデックス上では、index.htmlとcss/home.cssのファイル構成を記録する。
 
 ツリー2(圧縮ファイル A と B)を構成する ＆ コミット2 (ツリー2 親コミット1 作成者 日付 コミットメッセージ) を作成する 
 コミットには、ツリーと作成者、日時などを作成する。

### ファイルを変更したら 
 圧縮ファイルC(css/home.css)が作成されたとする。

 ステージ上のインデックスでは、圧縮ファイルC (index.html)とcss/home.cssのファイル構成を記録する。
 
 ツリー3(圧縮ファイル C と B)を構成する ＆ コミット (ツリー3 親コミット2 作成者 日付 コミットメッセージ) を作成する 
 コミットには、ツリーと作成者、日時などを作成する。
 
## より正確な話
 圧縮ファイルというのは、「blob(ブロブ)オブジェクト 」という。 blobというのは、「カタマリ」という意味です。ファイルの中身を圧縮しただけのカタマリということになる。

 また、圧縮ファイルのファイル名は、実際は、ハッシュIdのことを指す。ヘッダー(ファイルの内容の文字数やファイルのメタ情報)とファイル内容をSHA-1というハッシュ関数(英数字40文字以上)で変換したもの。

 ハッシュIDというのは、ファイルの中身に対して一意になるということです。中身が同じファイルであれば必ず同じハッシュIDになります。そのため、ファイルの中身が同じであれば git add しても追加で圧縮ファイルが作られることはありませんし、ファイルの中身に変更があれば git add すると別の圧縮ファイルが作成されます。

 ツリーファイルは一つのディレクトリに対応していて、ツリーファイルの中にツリーファイルと圧縮ファイルが含まれるようになっています。

# Gitのコマンド(新規学習分)
 ## 変更差分を確認する。
 ```
 # git addする前の変更分
 git diff
 git diff <ファイル名>

 # git addした後の変更分
 git diff --stagerd
 ## 変更差分を確認する。
 ```
 ## ファイルの変更履歴を確認する
 ```
 # git 
 git log
 # 一行で表示する
 git log --oneline
 # ファイルの変更差分を表示する
 git log -p index.html
 ```
 ## ファイルの消去を確認する
 ```
 # ファイルを消去 ワークツリー上も消去
 git rm <ファイル名>
 # ファイルを残したいとき ワークツリーは消去しない
 git rm --cached <ファイル名>
 ```

 ## バージョン管理しないファイルの無視

 .gitignoreを作成する。 

 ## ファイルへの変更を取り消す
 ステージの段階を反映さえ消去する。
 ```
 git checkout -- <ファイル名>
 git checkout -- <ディレクトリ名>
 
 #全変更を取り消す
 git checkout --

 #"--"とつけているのは、ブランチ名とファイル名がかぶったときに、
 どちらを指しているのがGitがわからなくなるのを避けるため。
 ```
 ## ステージした変更を取り消す
指定した変更をステージから取り出すだけなので、ワークツリーのファイルには、影響ない。

仕組みは、リポジトリから最新のコミットの情報を持ってきてその内容をステージの内容を上書きする
 ```
 git reset HEAD <ファイル名>
 git reset HEAD <ディレクトリ名>

 #全変更を取り消す
 git reest HEAD
 ```

 ## 直前のコミットをやり直す
これは、push前のみ使用が可能。使用後は、コミットをして修正が必要。

 ``` 
 git commit --amend 
 ```

 ## リモートから情報を取得する(フェッチ ＆ マージ)

 リモートリポジトリからローカルリポジトリへ保存する。
 保存先は、(remotes/リモート名/ブランチ名)
 
 その後マージをするとワークツリーへ反映することができる。

 ```
 # 詳細を知りたい場合
  git remote show origin
 ```

 ## リモートを変更する・消去する
+ リモート名を変更する 
 ```
 git remote rename <旧リモート名> <新リモート名>

 #example 
 git remote rename tutorial new_tutorial
 ```
 + リモート名を削除する
 ```
 git remote rm <リモート名>

 #example 
 git remote rm tutorial new_tutorial
 ```

